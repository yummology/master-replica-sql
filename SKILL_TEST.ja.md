# 背景

あるチームでは、とあるWebサービスにMySQLを利用しようと考えている。
DBはあるパブリッククラウドサービスのマネージドサービスを利用し、Master1つと負荷分散のためRead Replicaを複数台用意する予定である。

MasterおよびRead Replicaはパブリッククラウドサービスによる不定期なメンテナンスによって再起動することがある。
Masterのメンテナンスはサービスが停止している時間帯に行われるように設定できるが、
Read Replicaについてはサービス可動中にメンテナンスが行われる可能性がある。
なお、Read Replicaのメンテナンスは1台ずつ重複しないように行われる。

DBに接続するにあたって、チームのメンバーにMasterとRead Replicaを意識させず、
`database/sql`パッケージのDB型と同じように使えるライブラリを用意したいと考えた。
つまり、ライブラリの利用者はMasterとRead Replicaのどちらにリクエストを送るのか意識する必要はないが、
ライブラリ内部では、下図のように読み込み系のクエリの場合はRead Replicaにリクエストを送り、それ以外はMasterにリクエストを送るようにしたい。

![image.png](./image.png)


そこで、このチームでは`mydb`パッケージというライブラリを開発を行った（`mydb.go`として添付してあるもの）。
しかし、`mydb`パッケージは問題やバグを抱えていることが判明し改修することになった。

# 課題

## 課題1

以下の点を考慮し、現状のライブラリの問題点をあげよ。
なお、ここに挙げている視点以外の問題点も含めて構わない。

* 上記の背景から読み取れる要件を満たしているか
* ライブラリとして使いやすいか
* コードの品質が保証されているか
* 可読性が高いか
* スレッドセーフか

## 課題2

以下の点に注意して、課題1で挙げた問題点を解決するように、コードを改修せよ。
なお、ここに挙げている改善点以外に改善する箇所があれば積極的に改善して構わない。

* 合理的な理由があれば外部ライブラリ等を利用しても構わない
* ファイルやディレクトリを追加してもよい
* Go1.12以上で動作するようにせよ
* 合理的な理由による名称の変更や引数の変更など破壊的変更は構わない

## 課題3

課題2で改修する上で工夫した点を述べよ。

## 解答方法

解答はGitの`master`ブランチにコミットし、指定したGitHubのリポジトリへPushすること。
なお、解答には以下のファイルが必ず含まれているようにする。

* 課題1、課題3の解答が書かれた`answer.md`（Markdown形式）
* 作成したパッケージのインポートパスが書かれた`packages.txt`

`packages.txt`は以下のように、作成したパッケージのインポートパスを記述し、複数ある場合は改行によって区切ること。インポートパスは`""`で括る必要はない。なお、`packages.txt`は機械的な処理に用いる。

```
github.com/xxxxx/mydb
github.com/xxxxx/mylib
```

なお、`master`ブランチ以外のブランチやGitHubのissue、Pull Requst、コメント等への解答は採点対象とならないため注意すること。
